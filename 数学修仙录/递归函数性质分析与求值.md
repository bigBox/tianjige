# 递归函数性质分析与求值

## 问题描述

例5 定义域为正整数集的函数$f$满足：
$$f(n) = \begin{cases}
 n - 3, & n \geq 1000; \\
 f(f(n + 7)), & n < 1000.
\end{cases}$$
求$f(90)$。

## 问题分析

这是一个递归定义的函数，对于$n < 1000$的情况，函数值通过嵌套递归调用计算。直接递归计算会非常复杂，我们需要寻找函数的规律或周期性。

### 1. 分析$n \geq 1000$的情况

当$n \geq 1000$时，函数定义非常简单：$f(n) = n - 3$。这部分是我们解题的基础。

### 2. 寻找函数的规律

我们可以尝试计算一些接近1000的值，看看是否存在规律。

首先计算$f(997)$、$f(998)$、$f(999)$：

- $f(999) = f(f(1006)) = f(1006 - 3) = f(1003) = 1003 - 3 = 1000$
- $f(998) = f(f(1005)) = f(1005 - 3) = f(1002) = 1002 - 3 = 999$
- $f(997) = f(f(1004)) = f(1004 - 3) = f(1001) = 1001 - 3 = 998$
- $f(996) = f(f(1003)) = f(1000) = 1000 - 3 = 997$
- $f(995) = f(f(1002)) = f(999) = 1000$（根据上面的计算）

我们发现一个模式：从995开始，函数值开始循环：1000, 997, 998, 999, 1000, 997, 998, 999, ...

### 3. 寻找稳定点

当$n \geq 1000$时，$f(n) = n - 3$，所以对于较大的$n$，函数值会逐渐减小。但我们需要找到一个稳定点，即当$n < 1000$时，经过有限次递归后，结果会进入一个稳定的循环或固定值。

继续观察上面的计算，我们发现当$n$足够接近1000时，函数值最终会进入一个循环：1000 → 997 → 998 → 999 → 1000 → ...

### 4. 确定函数在特定区间的表达式

我们可以证明：对于$990 \leq n \leq 999$，函数$f(n)$的值如下：

- 当$n = 999$，$f(n) = 1000$
- 当$n = 998$，$f(n) = 999$
- 当$n = 997$，$f(n) = 998$
- 当$n = 996$，$f(n) = 997$
- 当$n = 995$，$f(n) = 1000$
- 当$n = 994$，$f(n) = 999$
- 当$n = 993$，$f(n) = 998$
- 当$n = 992$，$f(n) = 997$
- 当$n = 991$，$f(n) = 1000$
- 当$n = 990$，$f(n) = 999$

这里可以看到一个规律：对于$n \geq 990$，$f(n)$的值与$n \mod 4$有关。

### 5. 推广到更小的$n$

现在我们需要将这个规律推广到更小的$n$值，特别是$n = 90$。我们可以使用归纳法证明：对于任意$n$，当$n + 7k \geq 990$时，$f(n)$的值可以通过上述规律确定。

## 具体计算$f(90)$

我们需要找到最小的正整数$k$，使得$90 + 7k \geq 990$。

解不等式：
$7k \geq 900$
$k \geq \frac{900}{7} \approx 128.57$，所以$k = 129$

此时，$90 + 7 \times 129 = 90 + 903 = 993$

根据上面的规律，当$n = 993$时，$f(993) = 998$

现在我们需要计算$f(f(993)) = f(998) = 999$

但是等等，这里我们需要更仔细地分析递归过程。让我们重新计算：

$f(90) = f(f(97))$
$f(97) = f(f(104))$
...

这个过程会一直持续，直到我们达到$n \geq 990$的情况。

让我们尝试另一种方法，利用函数的周期性：

我们注意到，对于$n \geq 990$，函数$f(n)$的值呈现周期为4的循环：1000, 997, 998, 999, 1000, ...

我们可以计算$90$经过多少次加7操作后会落在$[990, 999]$区间内：

$90 + 7k \geq 990$ 解得 $k \geq 128.57$，即$k = 129$

此时，$90 + 7 \times 129 = 993$，对应$f(993) = 998$

接下来，我们需要计算$f(998) = 999$

但我们需要确认这个递归过程是否正确。让我们逐步验证：

### 更严谨的计算方法

我们可以定义一个函数$g(n) = f(n + 7) - f(n)$，然后寻找其规律。但更简单的方法是观察当$n$增加到$n + 7$时，函数值的变化。

实际上，对于这种类型的递归函数，通常存在一个"稳定区间"，当$n$足够大时，$f(n) = n - c$，其中$c$是一个常数。

我们可以猜测当$n$足够接近1000时，$f(n) = n - c$，代入递归式：

$f(n) = f(f(n + 7)) = f((n + 7) - c) = (n + 7 - c) - c = n + 7 - 2c$

另一方面，$f(n) = n - c$，所以：
$n - c = n + 7 - 2c$
解得$c = 7$

但这与我们之前的计算不符，说明猜测可能有误。让我们重新考虑。

### 正确的规律分析

实际上，我们可以证明：当$n \geq 990$时，$f(n) = n + 3$ 当$n \leq 996$，而当$n > 996$时，$f(n) = n - 3$。但这也不太对。

让我们重新整理思路，从后往前推导：

- $f(1000) = 997$
- $f(1001) = 998$
- $f(1002) = 999$
- $f(1003) = 1000$
- $f(1004) = 1001$
- $f(1005) = 1002$
- $f(1006) = 1003$

现在计算稍小的值：

- $f(999) = f(f(1006)) = f(1003) = 1000$
- $f(998) = f(f(1005)) = f(1002) = 999$
- $f(997) = f(f(1004)) = f(1001) = 998$
- $f(996) = f(f(1003)) = f(1000) = 997$
- $f(995) = f(f(1002)) = f(999) = 1000$
- $f(994) = f(f(1001)) = f(998) = 999$
- $f(993) = f(f(1000)) = f(997) = 998$
- $f(992) = f(f(999)) = f(1000) = 997$
- $f(991) = f(f(998)) = f(999) = 1000$
- $f(990) = f(f(997)) = f(998) = 999$

我们可以看到，从$n = 990$开始，函数值形成了一个周期为4的循环：999, 1000, 997, 998, 999, 1000, 997, 998, ...

### 计算$f(90)$

现在我们需要找到$90$经过多少次递归后会进入这个循环。注意到每次递归调用时，$n$会增加7，所以我们需要计算$90$需要加多少次7才能达到或超过990。

计算：$(990 - 90) \div 7 = 900 \div 7 = 128$余$4$

所以，$90 + 7 \times 128 = 90 + 896 = 986$

接下来我们需要计算$f(986)$，然后$f(f(986))$，依此类推。

但实际上，我们可以利用函数的周期性。注意到当$n \geq 990$时，函数值的周期为4，而$90 + 7k$的值会逐渐接近并超过990。

另一种方法是观察到对于$n < 1000$，$f(n) = f(f(n + 7))$，这意味着如果$n + 7k \geq 1000$，那么我们可以通过计算$f(n + 7k - 3^m)$来得到$f(n)$的值，其中$m$是递归的次数。

### 最终计算

我们可以证明，对于任意$n$，当$n + 7k \geq 1000$时，$f(n) = f(n + 7k - 3^m)$，其中$m$是使得$n + 7k - 3^m \geq 990$的最小整数。

对于$n = 90$，我们有$90 + 7 \times 129 = 993$，而$993 \geq 990$，所以$f(90) = f(f(97)) = f(f(f(104))) = ... = f(993) = 998$

但是，我们需要确认这个推导是否正确。让我们用另一种方法验证：

注意到从$n = 990$开始，函数值的周期为4，且
- 当$n \equiv 0 \mod 4$时，$f(n) = 999$
- 当$n \equiv 1 \mod 4$时，$f(n) = 1000$
- 当$n \equiv 2 \mod 4$时，$f(n) = 997$
- 当$n \equiv 3 \mod 4$时，$f(n) = 998$

对于$n = 993$，$993 \equiv 1 \mod 4$，所以$f(993) = 1000$？这与我们之前的计算矛盾，说明周期分析有误。

让我们重新整理函数值表：

- $f(990) = 999$
- $f(991) = 1000$
- $f(992) = 997$
- $f(993) = 998$
- $f(994) = 999$
- $f(995) = 1000$
- $f(996) = 997$
- $f(997) = 998$
- $f(998) = 999$
- $f(999) = 1000$

现在我们可以看到，周期实际上是4，但起始点不同：
- $n \equiv 2 \mod 4$时，$f(n) = 997$
- $n \equiv 3 \mod 4$时，$f(n) = 998$
- $n \equiv 0 \mod 4$时，$f(n) = 999$
- $n \equiv 1 \mod 4$时，$f(n) = 1000$

对于$n = 90$，我们需要找到$k$使得$90 + 7k \geq 990$且$90 + 7k$落在上述区间中。

$90 + 7 \times 129 = 993$，而$993 \equiv 1 \mod 4$，所以$f(993) = 1000$

接下来，$f(90) = f(f(97))$，而$f(97) = f(f(104)) = ... = f(993) = 1000$

因此，$f(90) = f(1000) = 997$

但是，我们需要再次验证这个结果。让我们用数学归纳法证明：

### 归纳法证明

假设对于所有$n > m$，$f(n)$的值已知，那么我们可以计算$f(m) = f(f(m + 7))$

从$n = 1000$开始，我们已经知道：
- $f(n) = n - 3$ 当$n \geq 1000$
- $f(999) = 1000$
- $f(998) = 999$
- $f(997) = 998$
- $f(996) = 997$
- $f(995) = 1000$

继续计算：
- $f(994) = f(f(1001)) = f(998) = 999$
- $f(993) = f(f(1000)) = f(997) = 998$
- $f(992) = f(f(999)) = f(1000) = 997$
- $f(991) = f(f(998)) = f(999) = 1000$
- $f(990) = f(f(997)) = f(998) = 999$
- $f(989) = f(f(996)) = f(997) = 998$
- $f(988) = f(f(995)) = f(1000) = 997$
- $f(987) = f(f(994)) = f(999) = 1000$
- $f(986) = f(f(993)) = f(998) = 999$

我们可以看到，从$n = 986$开始，函数值又开始重复之前的模式：999, 1000, 997, 998, 999, 1000, 997, 998, ...

这意味着函数$f(n)$对于$n \leq 999$的值实际上是周期性的，周期为4。

### 最终计算$f(90)$

现在我们可以利用这个周期性来计算$f(90)$。首先，我们需要找到$90$在这个周期中的位置。

计算$90$到$990$的距离：$990 - 90 = 900$

计算需要加多少次7才能达到或超过990：$900 \div 7 = 128$余$4$

所以，$90 + 7 \times 128 = 986$，而$f(986) = 999$

接下来，$f(90) = f(f(97))$，而$f(97) = f(f(104)) = ... = f(986) = 999$

因此，$f(90) = f(999) = 1000$

但是，我们需要再次验证这个结果。让我们使用另一种方法：

### 正确的计算方法

实际上，对于这种类型的递归函数，我们可以证明当$n \leq 990$时，$f(n) = 997 + ((990 - n) \mod 4)$

让我们验证一下：
- 对于$n = 990$，$f(990) = 999 = 997 + 2 = 997 + ((990 - 990) \mod 4) + 2$，看起来不太对。

让我们用另一种方法，从$n = 999$开始倒推：

- $f(999) = 1000$
- $f(998) = 999$
- $f(997) = 998$
- $f(996) = 997$
- $f(995) = 1000$
- ...

我们可以看到，函数值每4个数循环一次：1000, 999, 998, 997, 1000, 999, 998, 997, ...

对于$n = 90$，我们需要计算它在这个循环中的位置。计算$999 - 90 = 909$，然后$909 \div 4 = 227$余$1$

所以，$f(90) = f(999 - 909) = f(999 - 4 \times 227 - 1) = f(999 - 1) = f(998) = 999$

但是，这个结果也与之前的计算不同。让我们重新仔细计算：

### 最终正确的计算

我们可以通过观察发现，对于$n < 1000$，函数$f(n)$的值实际上是：

当$n + 7k \geq 1000$时，$f(n) = f(1000 - 3) = f(997) = 998$，其中$k$是使得$n + 7k \geq 1000$的最小整数。

但是，这也不对。让我们使用另一种方法，直接计算一些较小的值，看看是否有规律：

- $f(999) = 1000$
- $f(998) = 999$
- $f(997) = 998$
- $f(996) = 997$
- $f(995) = 1000$
- $f(994) = 999$
- $f(993) = 998$
- $f(992) = 997$
- $f(991) = 1000$
- $f(990) = 999$

现在我们可以看到，函数值的周期为4，且对于$n \geq 990$：
- 当$(n - 990) \mod 4 = 0$时，$f(n) = 999$
- 当$(n - 990) \mod 4 = 1$时，$f(n) = 1000$
- 当$(n - 990) \mod 4 = 2$时，$f(n) = 997$
- 当$(n - 990) \mod 4 = 3$时，$f(n) = 998$

对于$n = 90$，我们需要找到$k$使得$90 + 7k \geq 990$。解得$k = 129$，此时$90 + 7 \times 129 = 993$

计算$(993 - 990) \mod 4 = 3 \mod 4 = 3$，所以$f(993) = 998$

接下来，$f(90) = f(f(97))$，而$f(97) = f(f(104)) = ... = f(993) = 998$

因此，$f(90) = f(998)$

计算$(998 - 990) \mod 4 = 8 \mod 4 = 0$，所以$f(998) = 999$

所以，最终$f(90) = 999$

但是，我们需要再次确认这个结果。让我们用数学归纳法严格证明：

### 严格证明

我们定义一个序列$a_n = f(1000 - n)$，其中$n \geq 1$

根据函数定义：
- 当$n = 1, 2, 3$时，$a_n = f(1000 - n) = (1000 - n) - 3 = 997 - n$
- 当$n > 3$时，$a_n = f(1000 - n) = f(f(1000 - n + 7)) = f(f(1007 - n))$

对于$n > 3$且$1007 - n < 1000$（即$n > 7$），我们有$f(1007 - n) = f(f(1014 - n))$

这个过程会一直持续，直到我们达到$n \leq 7$的情况。

通过计算，我们可以发现序列$a_n$是周期性的，周期为4：
$a_1 = 996, a_2 = 995, a_3 = 994, a_4 = 997, a_5 = 996, a_6 = 995, a_7 = 994, a_8 = 997, ...$

但是这与我们之前的计算不符，说明哪里出错了。让我们重新计算：

实际上，正确的计算应该是：
- $f(999) = f(f(1006)) = f(1003) = 1000$
- $f(998) = f(f(1005)) = f(1002) = 999$
- $f(997) = f(f(1004)) = f(1001) = 998$
- $f(996) = f(f(1003)) = f(1000) = 997$
- $f(995) = f(f(1002)) = f(999) = 1000$
- $f(994) = f(f(1001)) = f(998) = 999$
- $f(993) = f(f(1000)) = f(997) = 998$
- $f(992) = f(f(999)) = f(1000) = 997$
- $f(991) = f(f(998)) = f(999) = 1000$
- $f(990) = f(f(997)) = f(998) = 999$

现在我们可以看到，从$n = 990$开始，函数值的周期为4：999, 1000, 997, 998, 999, 1000, 997, 998, ...

对于$n = 90$，我们需要找到$k$使得$90 + 7k \geq 990$。解得$k = 129$，此时$90 + 7 \times 129 = 993$

计算$993$在周期中的位置：$(993 - 990) \mod 4 = 3$，对应$f(993) = 998$

接下来，$f(90) = f(f(97))$，而$f(97) = f(f(104)) = ... = f(993) = 998$

因此，$f(90) = f(998)$

计算$998$在周期中的位置：$(998 - 990) \mod 4 = 8 \mod 4 = 0$，对应$f(998) = 999$

所以，最终$f(90) = 999$

但等等，我刚才的周期分析可能有误。让我再次验证：

从上面的计算我们可以看到：
- $f(990) = 999$
- $f(991) = 1000$
- $f(992) = 997$
- $f(993) = 998$
- $f(994) = 999$
- $f(995) = 1000$
- $f(996) = 997$
- $f(997) = 998$
- $f(998) = 999$
- $f(999) = 1000$

确实，周期为4，且对于$n \geq 990$：
- 当$(n - 990) \mod 4 = 0$时，$f(n) = 999$
- 当$(n - 990) \mod 4 = 1$时，$f(n) = 1000$
- 当$(n - 990) \mod 4 = 2$时，$f(n) = 997$
- 当$(n - 990) \mod 4 = 3$时，$f(n) = 998$

现在我们来计算$f(90)$：

我们需要找到最小的$k$使得$90 + 7k \geq 990$。解得$k = 129$，此时$90 + 7 \times 129 = 993$

根据上面的周期规律，$f(993) = 998$（因为$(993 - 990) \mod 4 = 3$）

接下来，$f(90) = f(f(97))$，而$f(97) = f(f(104)) = ... = f(993) = 998$

所以，$f(90) = f(998)$

根据周期规律，$f(998) = 999$（因为$(998 - 990) \mod 4 = 0$）

因此，最终$f(90) = 999$

## 最终答案

$f(90) = 999$