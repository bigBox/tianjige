# 非齐次线性递推数列求解

## 问题描述

已知数列 $\{a_n\}$ 满足初始条件 $a_1 = 1$，且对于 $n \geq 2$，有递推关系式：

$$a_n = \frac{2}{3}a_{n-1} + n^2 - 15$$

求数列的通项公式 $a_n$。

## 解题分析

这是一个一阶非齐次线性递推关系，形式为：

$$a_n = p \cdot a_{n-1} + f(n)$$

其中 $p = \frac{2}{3}$ 是常数，$f(n) = n^2 - 15$ 是非齐次项。

我们可以使用**常数变易法**来求解这类递推关系。具体步骤如下：

### 步骤1：求解对应的齐次方程

对应的齐次递推关系为：

$$a_n^{(h)} = \frac{2}{3}a_{n-1}^{(h)}$$

这是一个简单的等比数列，对于一阶齐次递推关系，当使用初始条件 $a_1$ 时，其标准通解形式为：

$$a_n^{(h)} = C \cdot \left(\frac{2}{3}\right)^{n-1}$$

其中 $C$ 是待定常数。

### 步骤2：使用常数变易法求非齐次方程的特解

假设非齐次方程的特解形式为：

$$a_n^{(p)} = C(n) \cdot \left(\frac{2}{3}\right)^n$$

将其代入原递推关系：

$$C(n) \cdot \left(\frac{2}{3}\right)^n = \frac{2}{3} \cdot C(n-1) \cdot \left(\frac{2}{3}\right)^{n-1} + n^2 - 15$$

化简得：

$$C(n) \cdot \left(\frac{2}{3}\right)^n = C(n-1) \cdot \left(\frac{2}{3}\right)^n + n^2 - 15$$

两边减去 $C(n-1) \cdot \left(\frac{2}{3}\right)^n$：

$$[C(n) - C(n-1)] \cdot \left(\frac{2}{3}\right)^n = n^2 - 15$$

解得：

$$C(n) - C(n-1) = (n^2 - 15) \cdot \left(\frac{3}{2}\right)^n$$

### 步骤3：求 $C(n)$

通过累加法求 $C(n)$：

$$C(n) = C(1) + \sum_{k=2}^{n} [C(k) - C(k-1)] = C(1) + \sum_{k=2}^{n} (k^2 - 15) \cdot \left(\frac{3}{2}\right)^k$$

为了简化计算，我们需要求出这个求和表达式。首先，我们需要计算几个求和公式：

1. $\sum_{k=1}^{n} k^2 \cdot r^k$（其中 $r = \frac{3}{2}$）
2. $\sum_{k=1}^{n} r^k$

对于等比数列求和，我们知道：

$$\sum_{k=1}^{n} r^k = r \cdot \frac{r^n - 1}{r - 1}$$

对于 $\sum_{k=1}^{n} k^2 \cdot r^k$，我们可以使用以下方法：

设 $S = \sum_{k=1}^{n} k^2 \cdot r^k$

则 $rS = \sum_{k=1}^{n} k^2 \cdot r^{k+1} = \sum_{k=2}^{n+1} (k-1)^2 \cdot r^k$

相减得：

$$(1-r)S = r + \sum_{k=2}^{n} [k^2 - (k-1)^2] \cdot r^k - n^2 \cdot r^{n+1}$$

$$(1-r)S = r + \sum_{k=2}^{n} (2k-1) \cdot r^k - n^2 \cdot r^{n+1}$$

继续分解这个求和，我们可以使用已知的求和公式，但这里为了简化，我们可以采用**待定系数法**来假设特解的形式。

由于非齐次项是二次多项式 $n^2 - 15$，我们可以假设特解也是一个二次多项式：

$$a_n^{(p)} = An^2 + Bn + C$$

其中 $A$, $B$, $C$ 是待定系数。

将特解代入原递推关系：

$$An^2 + Bn + C = \frac{2}{3}(A(n-1)^2 + B(n-1) + C) + n^2 - 15$$

展开右边：

$$\frac{2}{3}(A(n^2 - 2n + 1) + Bn - B + C) + n^2 - 15$$

$$= \frac{2A}{3}n^2 + \left(-\frac{4A}{3} + \frac{2B}{3}\right)n + \left(\frac{2A}{3} - \frac{2B}{3} + \frac{2C}{3}\right) + n^2 - 15$$

$$= \left(\frac{2A}{3} + 1\right)n^2 + \left(-\frac{4A}{3} + \frac{2B}{3}\right)n + \left(\frac{2A}{3} - \frac{2B}{3} + \frac{2C}{3} - 15\right)$$

比较两边的系数：

对于 $n^2$ 项：$A = \frac{2A}{3} + 1$，解得 $A = 3$

对于 $n$ 项：$B = -\frac{4A}{3} + \frac{2B}{3}$，代入 $A = 3$，得 $B = -4 + \frac{2B}{3}$，解得 $B = -12$

对于常数项：$C = \frac{2A}{3} - \frac{2B}{3} + \frac{2C}{3} - 15$，代入 $A = 3$, $B = -12$，得 $C = 2 + 8 + \frac{2C}{3} - 15$，解得 $C = -15$

因此，非齐次方程的一个特解为：

$$a_n^{(p)} = 3n^2 - 12n - 15$$

### 步骤4：求通解

原递推关系的通解为齐次解与特解之和：

$$a_n = a_n^{(h)} + a_n^{(p)} = C \cdot \left(\frac{2}{3}\right)^{n-1} + 3n^2 - 12n - 15$$

### 步骤5：利用初始条件确定常数 $C$

利用初始条件 $a_1 = 1$：

$$1 = C \cdot \left(\frac{2}{3}\right)^{1-1} + 3(1)^2 - 12(1) - 15$$

$$1 = C \cdot 1 + 3 - 12 - 15$$

$$1 = C - 24$$

解得：

$$C = 25$$

### 步骤6：得到最终通项公式

将 $C = 25$ 代入通解，得到：

$$a_n = 25 \cdot \left(\frac{2}{3}\right)^{n-1} + 3n^2 - 12n - 15$$

可以化简为：

$$a_n = 25 \cdot \frac{3}{2} \cdot \left(\frac{2}{3}\right)^n + 3n^2 - 12n - 15$$

$$a_n = \frac{75}{2} \left(\frac{2}{3}\right)^n + 3n^2 - 12n - 15$$

## 验证

让我们验证这个通项公式是否正确：

**验证 $a_1$**：

$$a_1 = 25 \cdot \left(\frac{2}{3}\right)^{1-1} + 3(1)^2 - 12(1) - 15 = 25 \cdot 1 + 3 - 12 - 15 = 25 + 3 - 12 - 15 = 1$$

符合初始条件。

**验证 $a_2$**：

根据递推关系：
$$a_2 = \frac{2}{3}a_1 + 2^2 - 15 = \frac{2}{3} \cdot 1 + 4 - 15 = \frac{2}{3} - 11 = -\frac{31}{3}$$

根据通项公式：
$$a_2 = 25 \cdot \left(\frac{2}{3}\right)^{2-1} + 3(2)^2 - 12(2) - 15 = 25 \cdot \frac{2}{3} + 12 - 24 - 15 = \frac{50}{3} - 27 = -\frac{31}{3}$$

验证正确。

## 最终结论

数列 $\{a_n\}$ 的通项公式为：

$$a_n = 25 \cdot \left(\frac{2}{3}\right)^{n-1} + 3n^2 - 12n - 15$$

也可以写成：

$$a_n = \frac{75}{2} \left(\frac{2}{3}\right)^n + 3n^2 - 12n - 15$$

或进一步整理为：

$$a_n = 3n^2 - 12n - 15 + 25 \cdot \left(\frac{2}{3}\right)^{n-1}$$