# 反正切函数和与二次方程根的关系分析

## 问题描述

设$\theta \in [-\pi, \pi]$，关于$x$的一元二次方程$x^2 + \sin\theta \cdot x + \cos\theta = 0$的两实根为$x_1, x_2$。令$f(\theta) = \arctan x_1 + \arctan x_2$。试求$f(\theta)$的解析式，并指出$f(\theta)$的定义域与值域。

## 问题分析

### 1. 定义域确定

首先，二次方程要有两个实根，判别式必须非负：

$$ \Delta = (\sin\theta)^2 - 4 \cdot 1 \cdot \cos\theta \geq 0 $$

即：

$$ \sin^2\theta - 4\cos\theta \geq 0 $$

利用三角恒等式$\sin^2\theta = 1 - \cos^2\theta$，代入得：

$$ 1 - \cos^2\theta - 4\cos\theta \geq 0 $$

整理为关于$\cos\theta$的二次不等式：

$$ \cos^2\theta + 4\cos\theta - 1 \leq 0 $$

解这个二次不等式，令$y = \cos\theta$，则不等式为：

$$ y^2 + 4y - 1 \leq 0 $$

求解二次方程$y^2 + 4y - 1 = 0$，得根为：

$$ y = \frac{-4 \pm \sqrt{16 + 4}}{2} = \frac{-4 \pm \sqrt{20}}{2} = \frac{-4 \pm 2\sqrt{5}}{2} = -2 \pm \sqrt{5} $$

由于$\sqrt{5} \approx 2.236$，所以$-2 + \sqrt{5} \approx 0.236$，$-2 - \sqrt{5} \approx -4.236$（超出余弦函数的值域$[-1, 1]$）。

因此，不等式的解为：

$$ -2 - \sqrt{5} \leq y \leq -2 + \sqrt{5} $$

考虑到$y = \cos\theta \in [-1, 1]$，实际解为：

$$ -1 \leq \cos\theta \leq -2 + \sqrt{5} $$

由此可得$\theta$的取值范围，即函数$f(\theta)$的定义域：

$$ \theta \in [-\pi, \pi] \cap \{\theta \mid \cos\theta \leq -2 + \sqrt{5}\}$$

计算$-2 + \sqrt{5}$的反余弦值：

$$ \arccos(-2 + \sqrt{5}) \approx \arccos(0.236) \approx 1.33 \text{ 弧度}$$

因此，定义域为：

$$ \theta \in [-\pi, -\arccos(-2 + \sqrt{5})] \cup [\arccos(-2 + \sqrt{5}), \pi] $$

### 2. 利用韦达定理和反正切和角公式

根据韦达定理，对于二次方程$x^2 + \sin\theta \cdot x + \cos\theta = 0$，有：

$$ x_1 + x_2 = -\sin\theta $$
$$ x_1 \cdot x_2 = \cos\theta $$

反正切函数的和角公式为：

$$ \arctan x_1 + \arctan x_2 = \arctan\left(\frac{x_1 + x_2}{1 - x_1 x_2}\right) + k\pi $$

其中$k$为整数，取决于$x_1$和$x_2$的符号。

代入韦达定理的结果：

$$ \arctan x_1 + \arctan x_2 = \arctan\left(\frac{-\sin\theta}{1 - \cos\theta}\right) + k\pi $$

### 3. 化简表达式

利用三角恒等式化简$\frac{-\sin\theta}{1 - \cos\theta}$：

$$ \frac{-\sin\theta}{1 - \cos\theta} = -\frac{2\sin\frac{\theta}{2}\cos\frac{\theta}{2}}{2\sin^2\frac{\theta}{2}} = -\cot\frac{\theta}{2} = -\tan\left(\frac{\pi}{2} - \frac{\theta}{2}\right) = \tan\left(\frac{\theta}{2} - \frac{\pi}{2}\right) $$

另外，也可以用另一种方式化简：

$$ \frac{-\sin\theta}{1 - \cos\theta} = \frac{\sin(-\theta)}{1 - \cos(-\theta)} = -\cot\left(\frac{-\theta}{2}\right) = \tan\left(\frac{-\theta}{2} + \frac{\pi}{2}\right) = \tan\left(\frac{\pi - \theta}{2}\right) $$

注意到$\tan\left(\frac{\pi - \theta}{2}\right) = \tan\left(\frac{\theta}{2} - \frac{\pi}{2} + \pi\right) = \tan\left(\frac{\theta}{2} - \frac{\pi}{2}\right)$，所以两种化简方式一致。

因此：

$$ \arctan x_1 + \arctan x_2 = \arctan\left[\tan\left(\frac{\pi - \theta}{2}\right)\right] + k\pi $$

### 4. 确定k的取值

k的取值取决于$1 - x_1 x_2$的符号，即$1 - \cos\theta$的符号。由于$\cos\theta \leq 1$，所以$1 - \cos\theta \geq 0$，当且仅当$\theta = 0$时等号成立。

同时，还需要考虑$x_1 + x_2 = -\sin\theta$的符号：

- 当$1 - \cos\theta > 0$且$x_1 + x_2 > 0$（即$-\sin\theta > 0$，$\sin\theta < 0$）时，$k = 0$
- 当$1 - \cos\theta > 0$且$x_1 + x_2 < 0$（即$\sin\theta > 0$）时，$k = 0$或$k = -1$，需要进一步分析
- 当$1 - \cos\theta = 0$（即$\theta = 0$）时，原方程变为$x^2 + 0 \cdot x + 1 = 0$，无实根，不在定义域内

另外，我们还可以通过分析$x_1$和$x_2$的符号来确定k值：

由$x_1 \cdot x_2 = \cos\theta$，在定义域内$\cos\theta \leq -2 + \sqrt{5} < 1$，且需要进一步确定$\cos\theta$的符号：

- 当$\cos\theta > 0$时，$x_1$和$x_2$同号
- 当$\cos\theta < 0$时，$x_1$和$x_2$异号
- 当$\cos\theta = 0$时，$x_1$和$x_2$中有一个为0

### 5. 更系统的分析方法

另一种方法是利用反正切函数的性质：

对于$\arctan x + \arctan y$，当$xy < 1$时：
$$ \arctan x + \arctan y = \arctan\left(\frac{x + y}{1 - xy}\right) $$

当$xy > 1$时：
- 若$x > 0, y > 0$，则$\arctan x + \arctan y = \arctan\left(\frac{x + y}{1 - xy}\right) + \pi$
- 若$x < 0, y < 0$，则$\arctan x + \arctan y = \arctan\left(\frac{x + y}{1 - xy}\right) - \pi$

当$xy = 1$时：
- 若$x > 0, y > 0$，则$\arctan x + \arctan y = \frac{\pi}{2}$
- 若$x < 0, y < 0$，则$\arctan x + \arctan y = -\frac{\pi}{2}$

在本题中，$xy = \cos\theta$，$x + y = -\sin\theta$

### 6. 确定f(θ)的解析式

让我们利用三角恒等式直接化简：

$$ \frac{-\sin\theta}{1 - \cos\theta} = -\cot\frac{\theta}{2} = \tan\left(\frac{\theta}{2} - \frac{\pi}{2}\right) $$

注意到$\arctan[\tan(\alpha)] = \alpha + k\pi$，其中$k$是使得结果落在$(-\frac{\pi}{2}, \frac{\pi}{2})$内的整数。

对于$\alpha = \frac{\theta}{2} - \frac{\pi}{2}$，由于$\theta \in [-\pi, \pi]$，则$\alpha \in [-\pi, 0]$。

因此，当$\alpha \in (-\frac{\pi}{2}, 0]$时，$k = 0$，即$\arctan[\tan(\alpha)] = \alpha$

当$\alpha \in [-\pi, -\frac{\pi}{2})$时，$k = 1$，即$\arctan[\tan(\alpha)] = \alpha + \pi$

结合定义域，我们需要更准确地分析。让我们换一种方式：

考虑到：

$$ \arctan x_1 + \arctan x_2 = \arctan\left(\frac{x_1 + x_2}{1 - x_1 x_2}\right) + k\pi $$

其中$k$满足：
- 当$x_1 x_2 < 1$时，$k = 0$（因为$x_1$和$x_2$异号时和在$(-\frac{\pi}{2}, \frac{\pi}{2})$内）
- 当$x_1 x_2 > 1$且$x_1, x_2 > 0$时，$k = 1$
- 当$x_1 x_2 > 1$且$x_1, x_2 < 0$时，$k = -1$

在本题定义域内，$\cos\theta \leq -2 + \sqrt{5} < 1$，所以$x_1 x_2 = \cos\theta < 1$，因此$k = 0$。

所以：

$$ f(\theta) = \arctan\left(\frac{-\sin\theta}{1 - \cos\theta}\right) $$

利用三角恒等式进一步化简：

$$ \frac{-\sin\theta}{1 - \cos\theta} = -\frac{\sin\theta}{1 - \cos\theta} = -\cot\frac{\theta}{2} = \tan\left(\frac{\theta}{2} - \frac{\pi}{2}\right) $$

又因为：

$$ \tan\left(\frac{\theta}{2} - \frac{\pi}{2}\right) = \tan\left(-\left(\frac{\pi}{2} - \frac{\theta}{2}\right)\right) = -\tan\left(\frac{\pi}{2} - \frac{\theta}{2}\right) = -\cot\frac{\theta}{2} $$

注意到$\arctan(-x) = -\arctan(x)$，所以：

$$ f(\theta) = -\arctan\left(\cot\frac{\theta}{2}\right) = -\arctan\left(\tan\left(\frac{\pi}{2} - \frac{\theta}{2}\right)\right) $$

由于$\frac{\pi}{2} - \frac{\theta}{2}$的范围：
- 当$\theta \in [-\pi, \pi]$时，$\frac{\pi}{2} - \frac{\theta}{2} \in [0, \pi]$

但反正切函数的值域是$(-\frac{\pi}{2}, \frac{\pi}{2})$，所以需要调整：

$$ \arctan\left(\tan\left(\frac{\pi}{2} - \frac{\theta}{2}\right)\right) = \begin{cases}
\frac{\pi}{2} - \frac{\theta}{2}, & \text{当} \frac{\pi}{2} - \frac{\theta}{2} \in (-\frac{\pi}{2}, \frac{\pi}{2}) \\n\frac{\pi}{2} - \frac{\theta}{2} - \pi, & \text{当} \frac{\pi}{2} - \frac{\theta}{2} \in [\frac{\pi}{2}, \frac{3\pi}{2}) \\
\end{cases} $$

化简条件：
- 当$\frac{\pi}{2} - \frac{\theta}{2} \in (-\frac{\pi}{2}, \frac{\pi}{2})$，即$\theta \in (0, 2\pi)$，但结合原定义域$\theta \in [-\pi, \pi]$，实际为$\theta \in (0, \pi]$
- 当$\frac{\pi}{2} - \frac{\theta}{2} \in [\frac{\pi}{2}, \frac{3\pi}{2})$，即$\theta \in [-2\pi, 0]$，结合原定义域，实际为$\theta \in [-\pi, 0]$

因此：

当$\theta \in (0, \pi]$时：
$$ f(\theta) = -\left(\frac{\pi}{2} - \frac{\theta}{2}\right) = \frac{\theta}{2} - \frac{\pi}{2} $$

当$\theta \in [-\pi, 0]$时：
$$ f(\theta) = -\left(\frac{\pi}{2} - \frac{\theta}{2} - \pi\right) = -\left(-\frac{\pi}{2} - \frac{\theta}{2}\right) = \frac{\pi}{2} + \frac{\theta}{2} $$

可以合并为：

$$ f(\theta) = \frac{\theta}{2} - \frac{\pi}{2} \cdot \text{sign}(\theta) $$

或者更简洁地：

$$ f(\theta) = \frac{\theta - \pi}{2} \text{，当} \theta \in (0, \pi] $$
$$ f(\theta) = \frac{\theta + \pi}{2} \text{，当} \theta \in [-\pi, 0] $$

这也可以写成：

$$ f(\theta) = \frac{\theta - \pi \cdot \text{sign}(\theta)}{2} $$

或者使用绝对值函数：

$$ f(\theta) = \frac{\theta}{2} - \frac{\pi}{2} \cdot \frac{|\theta|}{\theta} \text{（当}\theta \neq 0\text{）} $$

### 7. 验证结果

我们可以用特殊值验证：

当$\theta = \pi$时，方程为$x^2 + 0 \cdot x - 1 = 0$，根为$x = \pm 1$
$f(\pi) = \arctan(1) + \arctan(-1) = \frac{\pi}{4} - \frac{\pi}{4} = 0$
根据公式，当$\theta = \pi$时，$f(\theta) = \frac{\pi}{2} - \frac{\pi}{2} = 0$，正确。

当$\theta = -\pi$时，方程同样为$x^2 + 0 \cdot x - 1 = 0$，根为$x = \pm 1$
$f(-\pi) = \arctan(1) + \arctan(-1) = 0$
根据公式，当$\theta = -\pi$时，$f(\theta) = \frac{-\pi}{2} + \frac{\pi}{2} = 0$，正确。

## 最终结论

### 定义域

函数$f(\theta)$的定义域为：

$$ \theta \in [-\pi, -\arccos(-2 + \sqrt{5})] \cup [\arccos(-2 + \sqrt{5}), \pi] $$

其中$\arccos(-2 + \sqrt{5}) \approx 1.33$弧度。

### 解析式

函数$f(\theta)$的解析式为：

$$ f(\theta) = \begin{cases}
\frac{\theta + \pi}{2}, & \theta \in [-\pi, 0] \\
\frac{\theta - \pi}{2}, & \theta \in (0, \pi] \\
\end{cases} $$

或者可以写成：

$$ f(\theta) = \frac{\theta}{2} - \frac{\pi}{2} \cdot \text{sign}(\theta) $$

### 值域

根据解析式，当$\theta \in [-\pi, 0]$时，$f(\theta)$的取值范围为$[0, \frac{\pi}{2}]$

当$\theta \in (0, \pi]$时，$f(\theta)$的取值范围为$(-\frac{\pi}{2}, 0]$

但需要结合定义域进行调整。由于定义域是$\theta \in [-\pi, -a] \cup [a, \pi]$，其中$a = \arccos(-2 + \sqrt{5}) \approx 1.33$

当$\theta \in [-\pi, -a]$时，$f(\theta) = \frac{\theta + \pi}{2}$，取值范围为$[0, \frac{\pi - a}{2}]$

当$\theta \in [a, \pi]$时，$f(\theta) = \frac{\theta - \pi}{2}$，取值范围为$[\frac{a - \pi}{2}, 0]$

计算具体值：
$\frac{\pi - a}{2} \approx \frac{3.14 - 1.33}{2} \approx 0.905$
$\frac{a - \pi}{2} \approx \frac{1.33 - 3.14}{2} \approx -0.905$

因此，函数$f(\theta)$的值域为：

$$ \left[\frac{a - \pi}{2}, \frac{\pi - a}{2}\right] $$

其中$a = \arccos(-2 + \sqrt{5})$，约为$[-0.905, 0.905]$弧度。